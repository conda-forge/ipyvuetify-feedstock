From a18ad20d6b792551fa65cea2edfb0463373635dc Mon Sep 17 00:00:00 2001
From: Mario Buikhuizen <mariobuikhuizen@widgetti.io>
Date: Tue, 12 Mar 2024 15:37:32 +0100
Subject: [PATCH] build: only import pynpm when needed

---
 setup.py | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/setup.py b/setup.py
index 70dad75..63499a3 100644
--- a/setup.py
+++ b/setup.py
@@ -1,7 +1,6 @@
 import sys
 from pathlib import Path
 
-from pynpm import NPMPackage
 from setuptools import Command, setup
 from setuptools.command.egg_info import egg_info
 
@@ -29,7 +28,9 @@ def js_prerelease(command: Command) -> None:
 
         def run(self):
             """Run the command"""
-            if sys.argv[1] == "sdist" or sys.argv[1] == "dist_info":
+            if not (ROOT / "prefix/share/jupyter/nbextensions/jupyter-vuetify/index.js").exists():
+                from pynpm import NPMPackage
+
                 from generate_source import generate_source
 
                 npm = NPMPackage(ROOT / "js" / "package.json")
-- 
2.39.3 (Apple Git-145)

